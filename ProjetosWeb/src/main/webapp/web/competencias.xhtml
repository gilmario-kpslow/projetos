<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:c="http://xmlns.jcp.org/jsf/composite/componentes"

                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html">

    <ui:define name="conteudo">
        <h:form id="form">
            <c:outputMensagens />
            <c:panel titulo="Competencias">
                <h:dataTable value="#{competenciaBean.listaDeCompetencias}" var="competencia" styleClass="table table-hover table-responsive table-striped">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Ano"/>
                        </f:facet>
                        <h:outputText value="#{competencia.ano}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Mês"/>
                        </f:facet>
                        <h:outputText value="#{competencia.mes}" />
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Status"/>
                        </f:facet>
                        <h:outputText value="#{competencia.statusCompetencia}" />
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <div class="text-right">
                                <h:outputText value="Ação"/>
                            </div>
                        </f:facet>
                        <div class="text-right">
                            <h:commandLink styleClass="btn btn-info fa fa-calendar-check-o" onclick="$('#competenciaDialogModal').modal('show');" rendered="#{competencia.statusCompetencia == 'Aberta'}">
                                <f:ajax event="click" execute="@this" render="form:competenciaDialog:dialog" immediate="true" listener="#{competenciaBean.setCompetencia(competencia)}"/>
                            </h:commandLink>
                        </div>
                    </h:column>
                </h:dataTable>
            </c:panel>
            <c:dialog  titulo="Deseja encerrar essa Competência?" id_dialog="competenciaDialogModal" acao="#{competenciaBean.encerrarCompetencia()}" id="competenciaDialog" icon="fa fa-trash" render="@form">
                <h:panelGroup id="dialog">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 text-bold">
                            <h:outputText value="Competencia #{competenciaBean.competencia.mes} de #{competenciaBean.competencia.ano}"/>
                        </div>
                        <div class="col-lg-12 col-md-12">
                            <h:outputLabel value="Carteira" for="carteira" class="label label-primary"/>
                            <h:message for="carteira" styleClass="fa fa-ban text-danger" showDetail="false" showSummary="true" />
                            <div>
                                <h:selectOneMenu value="#{competenciaBean.carteira}" converter="#{carteiraConverter}" styleClass="form-control" id="carteira" requiredMessage="Selecione uma carteira para o encerramento" required="true">
                                    <f:selectItem itemLabel=" -- Selecione -- " itemValue="#{null}"/>
                                    <f:selectItems value="#{dashBoardBean.listaCarteiras}" itemValue="#{carteira}" itemLabel="#{carteira.nome}" var="carteira"/>
                                </h:selectOneMenu>
                            </div>
                        </div>
                    </div>
                </h:panelGroup>
            </c:dialog>
        </h:form>
    </ui:define>
</ui:composition>

